#include "TH1.h"
#include "TMath.h"
#include "TF1.h"
#include "TLegend.h"
#include "TCanvas.h"


void allMassPoints_fit() {

  gStyle->SetOptFit(1);
  //const int nBins = 21;
  //Double_t mass_xsec[nBins] = {1.1, 1.2, 1.3, 1.5, 1.7, 1.8, 1.9, 2., 2.2, 2.4, 2.6, 2.8, 3., 3.3, 3.5, 3.8, 4., 5., 6., 7., 8.};
  //Double_t xsec_higlu[nBins] = {3037930, 1006950, 476158, 189754, 110832, 97620, 80089, 70219, 61263, 54932, 49797, 48612, 51237, 49231, 47662, 44123, 41760, 31963, 24612, 19678, 16289};
  const int nBins = 15;
  //Double_t mass_xsec[nBins] = {1.1, 1.2, 1.3, 1.4, 1.5, 1.8, 2.0, 2.2, 2.5, 2.8, 4., 5., 6., 7., 8.};
  Double_t mass_xsec[nBins] = {1.2, 1.3, 1.4, 1.5, 1.8, 2.0, 2.2, 2.5, 2.8, 4., 5., 6., 7., 8., 20.};
  Double_t xsec_higlu[nBins] = {2631990, 1372070, 881140, 642097, 365239, 283080, 237671, 199051, 195270, 101029, 66799, 49249, 39060, 32812, 8062};

  // PSEUDOSCALAR, muR=muF=0.5*mH, NNPDF30_nlo_as_0118
  //Double_t xsec_higlu[nBins] = {77910740, 2631990, 1372070, 881140, 642097, 365239, 283080, 237671, 199051, 195270, 101029, 66799, 49249,  39060, 32812};
  // PSEUDOSCALAR, muR=muF=1.0*mH, NNPDF30_nlo_as_0118
  //Double_t xsec_higlu[nBins] = {390286, 353221, 328453, 289348, 264772, 211975, 190545, 176033, 165823, 184666, 95936, 61476, 44707, 35255, 29605};
  // PSEUDOSCALAR, muR=muF=1.5*mH, NNPDF30_nlo_as_0118
  //Double_t xsec_higlu[nBins] = {330921, 297527, 269880, 248342, 230848, 194394, 178726, 168927, 164308, 191095, 94697, 60293, 43428, 34039, 28502};
  // PSEUDOSCALAR, muR=muF=2.0*mH, NNPDF30_nlo_as_0118
  //Double_t xsec_higlu[nBins] = {300210, 273344, 251556, 233623, 218848, 187997, 175536, 167691, 164126, 193944, 95295, 59899, 42820, 33395, 27881};
  
  TGraph* g_fit_xsec = new TGraph(nBins, mass_xsec, xsec_higlu);
  TCanvas *c_fit_xsec = new TCanvas ("c_fit_xsec", "c_fit_xsec", 700, 500);

  g_fit_xsec -> GetXaxis() -> SetTitle("Mass [GeV]");
  g_fit_xsec -> GetYaxis() -> SetTitle("Cross section [pb]");
 
  g_fit_xsec -> SetLineColor(kRed);
  g_fit_xsec -> SetLineWidth(2);
  g_fit_xsec -> SetMarkerColor(kBlue);
  //c1->SetFrameFillColor(41);
  //c_fit_xsec -> SetGrid();
  //c_fit_xsec -> SetLogx();
  //c_fit_xsec -> SetLogy();

  Double_t xsec_line;
  Double_t xsec_spline;
  std::vector<float> xsec_l;
  std::vector<float> xsec_s;
  
  g_fit_xsec -> Draw("*AL");

  /* Double_t mass_allLimits[146] = {1.176, 1.187, 1.199, 1.211, 1.223, 1.235, 1.248, 1.26, 1.273, 1.286, 1.299, 1.312, 1.325, 1.338, 1.351, 1.365, 1.378, 1.392, 1.406, 1.42, 1.434, 1.449, 1.463,
				  1.478, 1.493, 1.508, 1.523, 1.538, 1.553, 1.569, 1.584, 1.6, 1.616, 1.632, 1.649, 1.665, 1.682, 1.699, 1.716, 1.733, 1.75, 1.768, 1.785, 1.803, 1.821, 1.839,
				  1.858, 1.876, 1.895, 1.914, 1.933, 1.953, 1.972, 1.992, 2.012, 2.032, 2.052, 2.073, 2.094, 2.114, 2.136, 2.157, 2.179, 2.2, 2.222, 2.245, 2.267, 2.29, 2.313,
				  2.336, 2.359, 2.383, 2.406, 2.43, 2.455, 2.479, 2.504, 2.529, 2.554, 2.58, 2.5801, 4.2009, 4.201, 4.243, 4.286, 4.328, 4.372, 4.415, 4.46, 4.504, 4.549, 4.595,
				  4.641, 4.687, 4.734, 4.781, 4.829, 4.877, 4.926, 4.975, 5.025, 5.075, 5.126, 5.177, 5.229, 5.282, 5.334, 5.388, 5.442, 5.496, 5.551, 5.606, 5.663, 5.719, 5.776,
				  5.834, 5.892, 5.951, 6.011, 6.071, 6.132, 6.193, 6.255, 6.318, 6.381, 6.445, 6.509, 6.574, 6.64, 6.706, 6.773, 6.841, 6.909, 6.978, 7.048, 7.119, 7.19, 7.262,
				  7.334, 7.408, 7.482, 7.557, 7.632, 7.709, 7.786, 7.864};
  */
  Double_t mass_allLimits[289] = {1.176, 1.181, 1.187, 1.193, 1.199, 1.205, 1.211, 1.217, 1.223, 1.229, 1.235, 1.242, 1.248, 1.254, 1.26, 1.267, 1.273, 1.279, 1.286, 1.292, 1.299, 1.305, 1.312, 1.318, 1.325, 1.331, 1.338, 1.345, 1.351, 1.358, 1.365, 1.372, 1.378, 1.385, 1.392, 1.399, 1.406, 1.413, 1.42, 1.427, 1.434, 1.442, 1.449, 1.456, 1.463, 1.471, 1.478, 1.485, 1.493, 1.5, 1.508, 1.515, 1.523, 1.53, 1.538, 1.546, 1.553, 1.561, 1.569, 1.577, 1.584, 1.592, 1.6, 1.608, 1.616, 1.624, 1.632, 1.641, 1.649, 1.657, 1.665, 1.674, 1.682, 1.69, 1.699, 1.707, 1.716, 1.724, 1.733, 1.742, 1.75, 1.759, 1.768, 1.777, 1.785, 1.794, 1.803, 1.812, 1.821, 1.83, 1.839, 1.849, 1.858, 1.867, 1.876, 1.886, 1.895, 1.905, 1.914, 1.924, 1.933, 1.943, 1.953, 1.962, 1.972, 1.982, 1.992, 2.002, 2.012, 2.022, 2.032, 2.042, 2.052, 2.062, 2.073, 2.083, 2.094, 2.104, 2.114, 2.125, 2.136, 2.146, 2.157, 2.168, 2.179, 2.189, 2.2, 2.211, 2.222, 2.233, 2.245, 2.256, 2.267, 2.278, 2.29, 2.301, 2.313, 2.324, 2.336, 2.347, 2.359, 2.371, 2.383, 2.394, 2.406, 2.418, 2.43, 2.443, 2.455, 2.467, 2.479, 2.492, 2.504, 2.517, 2.529, 2.542, 2.554, 2.567, 2.58,2.581,4.2,4.201,4.201, 4.222, 4.243, 4.264, 4.286, 4.307, 4.328, 4.35, 4.372, 4.394, 4.415, 4.437, 4.46, 4.482, 4.504, 4.527, 4.549, 4.572, 4.595, 4.618, 4.641, 4.664, 4.687, 4.71, 4.734, 4.758,4.781, 4.805, 4.829, 4.853, 4.877, 4.902, 4.926, 4.951, 4.975, 5.0, 5.025, 5.05, 5.075, 5.101, 5.126, 5.152, 5.177, 5.203, 5.229, 5.255, 5.282, 5.308, 5.334, 5.361, 5.388, 5.415, 5.442, 5.469, 5.496, 5.523, 5.551, 5.579, 5.606, 5.634, 5.663, 5.691, 5.719, 5.748, 5.776, 5.805, 5.834, 5.863, 5.892, 5.922, 5.951, 5.981, 6.011, 6.041, 6.071, 6.101, 6.132, 6.162, 6.193, 6.224, 6.255, 6.286, 6.318, 6.349, 6.381, 6.413, 6.445, 6.477, 6.509, 6.541, 6.574, 6.607, 6.64, 6.673, 6.706, 6.74, 6.773, 6.807, 6.841, 6.875, 6.909, 6.944, 6.978, 7.013, 7.048, 7.083, 7.119, 7.154, 7.19, 7.226, 7.262, 7.298, 7.334, 7.371, 7.408, 7.445, 7.482, 7.519, 7.557, 7.594, 7.632, 7.67, 7.709, 7.747, 7.786, 7.824, 7.864};
  
  for (int nbin = 0; nbin < 289; nbin++)
    //for (int nbin = 0; nbin < 146; nbin++)
    {
      //cout << "mass is :\t" << mass_allLimits[nbin] << endl;
      //xsec_line = g_fit_xsec -> Eval(mass_allLimits[nbin]);
      xsec_spline = g_fit_xsec -> Eval(mass_allLimits[nbin], 0, "S");
      //cout << nbin << '\t' << "xsec_line\t" << xsec_line << '\t' << "xsec_spline\t" << xsec_spline << endl;
      cout << mass_allLimits[nbin] << '\t' << '\t' << xsec_spline << endl;
      //xsec_l.push_back(xsec_line);
      xsec_s.push_back(xsec_spline);
    }
  //TSpline *s = (TSpline*)gROOT->FindObject("stemp");
  //xsec_spline = s -> Eval(6.6);

  //g_fit_xsec -> SetTitle("HIGLU cross section of a SM-like scalar particle");
  g_fit_xsec -> SetTitle("HIGLU cross section of a pseudoscalar particle");
}
